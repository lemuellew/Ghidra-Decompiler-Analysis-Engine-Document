\hypertarget{classRuleDivOpt}{}\doxysection{Rule\+Div\+Opt Class Reference}
\label{classRuleDivOpt}\index{RuleDivOpt@{RuleDivOpt}}


Convert I\+N\+T\+\_\+\+M\+U\+LT and shift forms into I\+N\+T\+\_\+\+D\+IV or I\+N\+T\+\_\+\+S\+D\+IV.  




Inheritance diagram for Rule\+Div\+Opt\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=152pt]{classRuleDivOpt__inherit__graph}
\end{center}
\end{figure}


Collaboration diagram for Rule\+Div\+Opt\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=152pt]{classRuleDivOpt__coll__graph}
\end{center}
\end{figure}
\doxysubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
virtual \mbox{\hyperlink{classRule}{Rule}} $\ast$ \mbox{\hyperlink{classRuleDivOpt_a4fb0c5c3f7dec93f20d65f1919693802}{clone}} (const \mbox{\hyperlink{classActionGroupList}{Action\+Group\+List}} \&grouplist) const
\begin{DoxyCompactList}\small\item\em Clone the \mbox{\hyperlink{classRule}{Rule}}. \end{DoxyCompactList}\item 
virtual void \mbox{\hyperlink{classRuleDivOpt_adff3658edfa28c90464397a2e7c5b739}{get\+Op\+List}} (vector$<$ uint4 $>$ \&oplist) const
\begin{DoxyCompactList}\small\item\em List of op codes this rule operates on. \end{DoxyCompactList}\item 
virtual int4 \mbox{\hyperlink{classRuleDivOpt_a8443133b32d917f3b751ba1fa7dee8f1}{apply\+Op}} (\mbox{\hyperlink{classPcodeOp}{Pcode\+Op}} $\ast$op, \mbox{\hyperlink{classFuncdata}{Funcdata}} \&data)
\begin{DoxyCompactList}\small\item\em Attempt to apply {\bfseries{this}} \mbox{\hyperlink{classRule}{Rule}}. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsection*{Static Public Member Functions}
\begin{DoxyCompactItemize}
\item 
static \mbox{\hyperlink{classVarnode}{Varnode}} $\ast$ \mbox{\hyperlink{classRuleDivOpt_a07d4553e1000d607d3a49bd27d4425c3}{find\+Form}} (\mbox{\hyperlink{classPcodeOp}{Pcode\+Op}} $\ast$op, int4 \&n, uintb \&y, int4 \&xsize, \mbox{\hyperlink{opcodes_8hh_abeb7dfb0e9e2b3114e240a405d046ea7}{Op\+Code}} \&extopc)
\begin{DoxyCompactList}\small\item\em Check for I\+N\+T\+\_\+(\+S)R\+I\+G\+HT and/or S\+U\+B\+P\+I\+E\+CE followed by I\+N\+T\+\_\+\+M\+U\+LT. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsection*{Additional Inherited Members}


\doxysubsection{Detailed Description}
Convert I\+N\+T\+\_\+\+M\+U\+LT and shift forms into I\+N\+T\+\_\+\+D\+IV or I\+N\+T\+\_\+\+S\+D\+IV. 

The unsigned and signed variants are\+:
\begin{DoxyItemize}
\item {\ttfamily sub( (zext(\+V)$\ast$c)$>$$>$n, 0) =$>$ V / (2$^\wedge$n/(c-\/1))}
\item {\ttfamily sub( (sext(\+V)$\ast$c)s$>$$>$n, 0) =$>$ V s/ (2$^\wedge$n/(c-\/1))} 
\end{DoxyItemize}

\doxysubsection{Member Function Documentation}
\mbox{\Hypertarget{classRuleDivOpt_a8443133b32d917f3b751ba1fa7dee8f1}\label{classRuleDivOpt_a8443133b32d917f3b751ba1fa7dee8f1}} 
\index{RuleDivOpt@{RuleDivOpt}!applyOp@{applyOp}}
\index{applyOp@{applyOp}!RuleDivOpt@{RuleDivOpt}}
\doxysubsubsection{\texorpdfstring{applyOp()}{applyOp()}}
{\footnotesize\ttfamily int4 Rule\+Div\+Opt\+::apply\+Op (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classPcodeOp}{Pcode\+Op}} $\ast$}]{op,  }\item[{\mbox{\hyperlink{classFuncdata}{Funcdata}} \&}]{data }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}}



Attempt to apply {\bfseries{this}} \mbox{\hyperlink{classRule}{Rule}}. 

This method contains the main logic for applying the \mbox{\hyperlink{classRule}{Rule}}. It must use a given \mbox{\hyperlink{classPcodeOp}{Pcode\+Op}} as the point at which the \mbox{\hyperlink{classRule}{Rule}} applies. If it does apply, changes are made directly to the function and 1 (non-\/zero) is returned, otherwise 0 is returned. 
\begin{DoxyParams}{Parameters}
{\em op} & is the given \mbox{\hyperlink{classPcodeOp}{Pcode\+Op}} where the \mbox{\hyperlink{classRule}{Rule}} may apply \\
\hline
{\em data} & is the function to which to apply \\
\hline
\end{DoxyParams}


Reimplemented from \mbox{\hyperlink{classRule_a4e3e61f066670175009f60fb9dc60848}{Rule}}.

\mbox{\Hypertarget{classRuleDivOpt_a4fb0c5c3f7dec93f20d65f1919693802}\label{classRuleDivOpt_a4fb0c5c3f7dec93f20d65f1919693802}} 
\index{RuleDivOpt@{RuleDivOpt}!clone@{clone}}
\index{clone@{clone}!RuleDivOpt@{RuleDivOpt}}
\doxysubsubsection{\texorpdfstring{clone()}{clone()}}
{\footnotesize\ttfamily virtual \mbox{\hyperlink{classRule}{Rule}}$\ast$ Rule\+Div\+Opt\+::clone (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{classActionGroupList}{Action\+Group\+List}} \&}]{grouplist }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [virtual]}}



Clone the \mbox{\hyperlink{classRule}{Rule}}. 

If {\bfseries{this}} \mbox{\hyperlink{classRule}{Rule}} is a member of one of the groups in the grouplist, this returns a clone of the \mbox{\hyperlink{classRule}{Rule}}, otherwise N\+U\+LL is returned. 
\begin{DoxyParams}{Parameters}
{\em grouplist} & is the list of groups being cloned \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
the cloned \mbox{\hyperlink{classRule}{Rule}} or N\+U\+LL 
\end{DoxyReturn}


Implements \mbox{\hyperlink{classRule_a70de90a76461bfa7ea0b575ce3c11e4d}{Rule}}.

\mbox{\Hypertarget{classRuleDivOpt_a07d4553e1000d607d3a49bd27d4425c3}\label{classRuleDivOpt_a07d4553e1000d607d3a49bd27d4425c3}} 
\index{RuleDivOpt@{RuleDivOpt}!findForm@{findForm}}
\index{findForm@{findForm}!RuleDivOpt@{RuleDivOpt}}
\doxysubsubsection{\texorpdfstring{findForm()}{findForm()}}
{\footnotesize\ttfamily \mbox{\hyperlink{classVarnode}{Varnode}} $\ast$ Rule\+Div\+Opt\+::find\+Form (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classPcodeOp}{Pcode\+Op}} $\ast$}]{op,  }\item[{int4 \&}]{n,  }\item[{uintb \&}]{y,  }\item[{int4 \&}]{xsize,  }\item[{\mbox{\hyperlink{opcodes_8hh_abeb7dfb0e9e2b3114e240a405d046ea7}{Op\+Code}} \&}]{extopc }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}



Check for I\+N\+T\+\_\+(\+S)R\+I\+G\+HT and/or S\+U\+B\+P\+I\+E\+CE followed by I\+N\+T\+\_\+\+M\+U\+LT. 

Look for the forms\+:
\begin{DoxyItemize}
\item {\ttfamily sub(ext(\+X) $\ast$ \#y,\#c)} or
\item {\ttfamily sub(ext(\+X) $\ast$ \#y,\#c) $>$$>$ n} or
\item {\ttfamily (ext(\+X) $\ast$ \#y) $>$$>$ n}
\end{DoxyItemize}

Looks for truncation/multiplication consistent with an optimized division. The truncation can come as either a S\+U\+B\+P\+I\+E\+CE operation and/or right shifts. The numerand and the amount it has been extended is discovered. The extension can be, but doesn\textquotesingle{}t have to be, an explicit I\+N\+T\+\_\+\+Z\+E\+XT or I\+N\+T\+\_\+\+S\+E\+XT. If the form doesn\textquotesingle{}t match N\+U\+LL is returned. If the \mbox{\hyperlink{classVarnode}{Varnode}} holding the extended numerand matches the final operand size, it is returned, otherwise the unextended numerand is returned. The total truncation, the multiplicative constant, the numerand size, and the extension type are all passed back. 
\begin{DoxyParams}{Parameters}
{\em op} & is the root of the expression \\
\hline
{\em n} & is the reference that will hold the total number of bits of truncation \\
\hline
{\em y} & will hold the multiplicative constant \\
\hline
{\em xsize} & will hold the number of (non-\/zero) bits in the numerand \\
\hline
{\em extopc} & holds whether the extension is I\+N\+T\+\_\+\+Z\+E\+XT or I\+N\+T\+\_\+\+S\+E\+XT \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
the extended numerand if possible, or the unextended numerand, or N\+U\+LL 
\end{DoxyReturn}
\mbox{\Hypertarget{classRuleDivOpt_adff3658edfa28c90464397a2e7c5b739}\label{classRuleDivOpt_adff3658edfa28c90464397a2e7c5b739}} 
\index{RuleDivOpt@{RuleDivOpt}!getOpList@{getOpList}}
\index{getOpList@{getOpList}!RuleDivOpt@{RuleDivOpt}}
\doxysubsubsection{\texorpdfstring{getOpList()}{getOpList()}}
{\footnotesize\ttfamily void Rule\+Div\+Opt\+::get\+Op\+List (\begin{DoxyParamCaption}\item[{vector$<$ uint4 $>$ \&}]{oplist }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [virtual]}}



List of op codes this rule operates on. 

Populate the given array with all possible Op\+Codes this \mbox{\hyperlink{classRule}{Rule}} might apply to. By default, this method returns all possible Op\+Codes 
\begin{DoxyParams}{Parameters}
{\em oplist} & is the array to populate \\
\hline
\end{DoxyParams}


Reimplemented from \mbox{\hyperlink{classRule_a4023bfc7825de0ab866790551856d10e}{Rule}}.



The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{ruleaction_8hh}{ruleaction.\+hh}}\item 
ruleaction.\+cc\end{DoxyCompactItemize}
