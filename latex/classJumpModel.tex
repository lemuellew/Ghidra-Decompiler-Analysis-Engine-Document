\hypertarget{classJumpModel}{}\doxysection{Jump\+Model Class Reference}
\label{classJumpModel}\index{JumpModel@{JumpModel}}


A jump-\/table execution model.  




{\ttfamily \#include $<$jumptable.\+hh$>$}



Inheritance diagram for Jump\+Model\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classJumpModel__inherit__graph}
\end{center}
\end{figure}


Collaboration diagram for Jump\+Model\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=169pt]{classJumpModel__coll__graph}
\end{center}
\end{figure}
\doxysubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\Hypertarget{classJumpModel_af54c70c0bcedfcf45ed1ce6895d9e2db}\label{classJumpModel_af54c70c0bcedfcf45ed1ce6895d9e2db}} 
virtual bool \mbox{\hyperlink{classJumpModel_af54c70c0bcedfcf45ed1ce6895d9e2db}{is\+Override}} (void) const =0
\begin{DoxyCompactList}\small\item\em Return {\bfseries{true}} if {\bfseries{this}} model was manually overridden. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{classJumpModel_acbc757d5fe05e9e8cb15697ddc73f367}\label{classJumpModel_acbc757d5fe05e9e8cb15697ddc73f367}} 
virtual int4 \mbox{\hyperlink{classJumpModel_acbc757d5fe05e9e8cb15697ddc73f367}{get\+Table\+Size}} (void) const =0
\begin{DoxyCompactList}\small\item\em Return the number of entries in the address table. \end{DoxyCompactList}\item 
virtual bool \mbox{\hyperlink{classJumpModel_a9c2326278dd18c9d78dd5cd5795e802b}{recover\+Model}} (\mbox{\hyperlink{classFuncdata}{Funcdata}} $\ast$fd, \mbox{\hyperlink{classPcodeOp}{Pcode\+Op}} $\ast$indop, uint4 matchsize, uint4 maxtablesize)=0
\begin{DoxyCompactList}\small\item\em Attempt to recover details of the model, given a specific B\+R\+A\+N\+C\+H\+I\+ND. \end{DoxyCompactList}\item 
virtual void \mbox{\hyperlink{classJumpModel_a12659a93442cc2940a8fed8dc55be2e0}{build\+Addresses}} (\mbox{\hyperlink{classFuncdata}{Funcdata}} $\ast$fd, \mbox{\hyperlink{classPcodeOp}{Pcode\+Op}} $\ast$indop, vector$<$ \mbox{\hyperlink{classAddress}{Address}} $>$ \&addresstable, vector$<$ \mbox{\hyperlink{classLoadTable}{Load\+Table}} $>$ $\ast$loadpoints) const =0
\begin{DoxyCompactList}\small\item\em Construct the explicit list of target addresses (the \mbox{\hyperlink{classAddress}{Address}} Table) from {\bfseries{this}} model. \end{DoxyCompactList}\item 
virtual void \mbox{\hyperlink{classJumpModel_aac83f52fbf3ee566e760dfabe6e67ee6}{find\+Unnormalized}} (uint4 maxaddsub, uint4 maxleftright, uint4 maxext)=0
\begin{DoxyCompactList}\small\item\em Recover the unnormalized switch variable. \end{DoxyCompactList}\item 
virtual void \mbox{\hyperlink{classJumpModel_af8e7b936b4b51d87b7690693f756ffd6}{build\+Labels}} (\mbox{\hyperlink{classFuncdata}{Funcdata}} $\ast$fd, vector$<$ \mbox{\hyperlink{classAddress}{Address}} $>$ \&addresstable, vector$<$ uintb $>$ \&label, const \mbox{\hyperlink{classJumpModel}{Jump\+Model}} $\ast$orig) const =0
\begin{DoxyCompactList}\small\item\em Recover {\itshape case} labels associated with the \mbox{\hyperlink{classAddress}{Address}} table. \end{DoxyCompactList}\item 
virtual \mbox{\hyperlink{classVarnode}{Varnode}} $\ast$ \mbox{\hyperlink{classJumpModel_a7e8f2d4d8a1ae1954e00aae96c74a8c4}{fold\+In\+Normalization}} (\mbox{\hyperlink{classFuncdata}{Funcdata}} $\ast$fd, \mbox{\hyperlink{classPcodeOp}{Pcode\+Op}} $\ast$indop)=0
\begin{DoxyCompactList}\small\item\em Do normalization of the given switch specific to {\bfseries{this}} model. \end{DoxyCompactList}\item 
virtual bool \mbox{\hyperlink{classJumpModel_a6f40ba77ddc8f4cf40f6071248103d9c}{fold\+In\+Guards}} (\mbox{\hyperlink{classFuncdata}{Funcdata}} $\ast$fd, \mbox{\hyperlink{classJumpTable}{Jump\+Table}} $\ast$jump)=0
\begin{DoxyCompactList}\small\item\em Eliminate any {\itshape guard} code involved in computing the switch destination. \end{DoxyCompactList}\item 
virtual bool \mbox{\hyperlink{classJumpModel_a76a52bf3311e9d97a61d1117f6de1b0a}{sanity\+Check}} (\mbox{\hyperlink{classFuncdata}{Funcdata}} $\ast$fd, \mbox{\hyperlink{classPcodeOp}{Pcode\+Op}} $\ast$indop, vector$<$ \mbox{\hyperlink{classAddress}{Address}} $>$ \&addresstable)=0
\begin{DoxyCompactList}\small\item\em Perform a sanity check on recovered addresses. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{classJumpModel_af4eef0f1c319eb049c518631a0321ddd}\label{classJumpModel_af4eef0f1c319eb049c518631a0321ddd}} 
virtual \mbox{\hyperlink{classJumpModel}{Jump\+Model}} $\ast$ \mbox{\hyperlink{classJumpModel_af4eef0f1c319eb049c518631a0321ddd}{clone}} (\mbox{\hyperlink{classJumpTable}{Jump\+Table}} $\ast$jt) const =0
\begin{DoxyCompactList}\small\item\em Clone {\bfseries{this}} model. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsection*{Protected Attributes}
\begin{DoxyCompactItemize}
\item 
\mbox{\Hypertarget{classJumpModel_a3254101eed73a4e245587679682b510d}\label{classJumpModel_a3254101eed73a4e245587679682b510d}} 
\mbox{\hyperlink{classJumpTable}{Jump\+Table}} $\ast$ \mbox{\hyperlink{classJumpModel_a3254101eed73a4e245587679682b510d}{jumptable}}
\begin{DoxyCompactList}\small\item\em The jump-\/table that is building {\bfseries{this}} model. \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
A jump-\/table execution model. 

This class holds details of the model and recovers these details in various stages. The model concepts include\+:
\begin{DoxyItemize}
\item \mbox{\hyperlink{classAddress}{Address}} Table, the set of destination addresses the jump-\/table can produce.
\item Normalized Switch Variable, the \mbox{\hyperlink{classVarnode}{Varnode}} with the most restricted set of values used by the model to produce the destination addresses.
\item Unnormalized Switch Variable, the \mbox{\hyperlink{classVarnode}{Varnode}} being switched on, as seen in the decompiler output.
\item Case labels, switch variable values associated with specific destination addresses.
\item Guards, C\+B\+R\+A\+N\+CH ops that enforce the normalized switch variable\textquotesingle{}s value range. 
\end{DoxyItemize}

\doxysubsection{Member Function Documentation}
\mbox{\Hypertarget{classJumpModel_a12659a93442cc2940a8fed8dc55be2e0}\label{classJumpModel_a12659a93442cc2940a8fed8dc55be2e0}} 
\index{JumpModel@{JumpModel}!buildAddresses@{buildAddresses}}
\index{buildAddresses@{buildAddresses}!JumpModel@{JumpModel}}
\doxysubsubsection{\texorpdfstring{buildAddresses()}{buildAddresses()}}
{\footnotesize\ttfamily virtual void Jump\+Model\+::build\+Addresses (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classFuncdata}{Funcdata}} $\ast$}]{fd,  }\item[{\mbox{\hyperlink{classPcodeOp}{Pcode\+Op}} $\ast$}]{indop,  }\item[{vector$<$ \mbox{\hyperlink{classAddress}{Address}} $>$ \&}]{addresstable,  }\item[{vector$<$ \mbox{\hyperlink{classLoadTable}{Load\+Table}} $>$ $\ast$}]{loadpoints }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [pure virtual]}}



Construct the explicit list of target addresses (the \mbox{\hyperlink{classAddress}{Address}} Table) from {\bfseries{this}} model. 

The addresses produced all come from the B\+R\+A\+N\+C\+H\+I\+ND and may not be deduped. Alternate guard destinations are not yet included. 
\begin{DoxyParams}{Parameters}
{\em fd} & is the function containing the switch \\
\hline
{\em indop} & is the root B\+R\+A\+N\+C\+H\+I\+ND of the switch \\
\hline
{\em addresstable} & will hold the list of Addresses \\
\hline
{\em loadpoints} & if non-\/null will hold L\+O\+AD table information used by the model \\
\hline
\end{DoxyParams}


Implemented in \mbox{\hyperlink{classJumpAssisted_aff52f4a983f867d9bd105a6856e473a5}{Jump\+Assisted}}, \mbox{\hyperlink{classJumpBasicOverride_ad9a026df124c7e57722bdc1903033ebb}{Jump\+Basic\+Override}}, \mbox{\hyperlink{classJumpBasic_a42533b11d12a5f819bb88abb21037d94}{Jump\+Basic}}, and \mbox{\hyperlink{classJumpModelTrivial_a598ff420975134b8921c4a5ade192e0f}{Jump\+Model\+Trivial}}.

\mbox{\Hypertarget{classJumpModel_af8e7b936b4b51d87b7690693f756ffd6}\label{classJumpModel_af8e7b936b4b51d87b7690693f756ffd6}} 
\index{JumpModel@{JumpModel}!buildLabels@{buildLabels}}
\index{buildLabels@{buildLabels}!JumpModel@{JumpModel}}
\doxysubsubsection{\texorpdfstring{buildLabels()}{buildLabels()}}
{\footnotesize\ttfamily virtual void Jump\+Model\+::build\+Labels (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classFuncdata}{Funcdata}} $\ast$}]{fd,  }\item[{vector$<$ \mbox{\hyperlink{classAddress}{Address}} $>$ \&}]{addresstable,  }\item[{vector$<$ uintb $>$ \&}]{label,  }\item[{const \mbox{\hyperlink{classJumpModel}{Jump\+Model}} $\ast$}]{orig }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [pure virtual]}}



Recover {\itshape case} labels associated with the \mbox{\hyperlink{classAddress}{Address}} table. 

The unnormalized switch variable must already be recovered. Values that the normalized switch value can hold or walked back to obtain the value that the unnormalized switch variable would hold. Labels are returned in the order provided by normalized switch variable iterator \mbox{\hyperlink{classJumpValues}{Jump\+Values}}. 
\begin{DoxyParams}{Parameters}
{\em fd} & is the function containing the switch \\
\hline
{\em addresstable} & is the address table (used to label code blocks with bad or missing labels) \\
\hline
{\em label} & will hold recovered labels in \mbox{\hyperlink{classJumpValues}{Jump\+Values}} order \\
\hline
{\em orig} & is the \mbox{\hyperlink{classJumpModel}{Jump\+Model}} to use for the \mbox{\hyperlink{classJumpValues}{Jump\+Values}} iterator \\
\hline
\end{DoxyParams}


Implemented in \mbox{\hyperlink{classJumpAssisted_aa8d0c353dd73697469c552b04146efe6}{Jump\+Assisted}}, \mbox{\hyperlink{classJumpBasicOverride_a1fff9a672edb2225dae051d7ed6b57b5}{Jump\+Basic\+Override}}, \mbox{\hyperlink{classJumpBasic_ad3c8a1257f973c18e25935ee932076c4}{Jump\+Basic}}, and \mbox{\hyperlink{classJumpModelTrivial_a2f156e909104f7a992e61a288e207c08}{Jump\+Model\+Trivial}}.

\mbox{\Hypertarget{classJumpModel_aac83f52fbf3ee566e760dfabe6e67ee6}\label{classJumpModel_aac83f52fbf3ee566e760dfabe6e67ee6}} 
\index{JumpModel@{JumpModel}!findUnnormalized@{findUnnormalized}}
\index{findUnnormalized@{findUnnormalized}!JumpModel@{JumpModel}}
\doxysubsubsection{\texorpdfstring{findUnnormalized()}{findUnnormalized()}}
{\footnotesize\ttfamily virtual void Jump\+Model\+::find\+Unnormalized (\begin{DoxyParamCaption}\item[{uint4}]{maxaddsub,  }\item[{uint4}]{maxleftright,  }\item[{uint4}]{maxext }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [pure virtual]}}



Recover the unnormalized switch variable. 

The normalized switch variable must already be recovered. The amount of normalization between the two switch variables can be restricted. 
\begin{DoxyParams}{Parameters}
{\em maxaddsub} & is a restriction on arithmetic operations \\
\hline
{\em maxleftright} & is a restriction on shift operations \\
\hline
{\em maxext} & is a restriction on extension operations \\
\hline
\end{DoxyParams}


Implemented in \mbox{\hyperlink{classJumpAssisted_a76bb3f116ab239f3b3f3fcf0410028d7}{Jump\+Assisted}}, \mbox{\hyperlink{classJumpBasic2_ab5d1cebab5d2f98d0caf6fc551b29980}{Jump\+Basic2}}, \mbox{\hyperlink{classJumpBasic_a2d542e5a6b74bd116d89ba4e5bb4da9b}{Jump\+Basic}}, and \mbox{\hyperlink{classJumpModelTrivial_a76017216abd7b4389f42e331d025d9dc}{Jump\+Model\+Trivial}}.

\mbox{\Hypertarget{classJumpModel_a6f40ba77ddc8f4cf40f6071248103d9c}\label{classJumpModel_a6f40ba77ddc8f4cf40f6071248103d9c}} 
\index{JumpModel@{JumpModel}!foldInGuards@{foldInGuards}}
\index{foldInGuards@{foldInGuards}!JumpModel@{JumpModel}}
\doxysubsubsection{\texorpdfstring{foldInGuards()}{foldInGuards()}}
{\footnotesize\ttfamily virtual bool Jump\+Model\+::fold\+In\+Guards (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classFuncdata}{Funcdata}} $\ast$}]{fd,  }\item[{\mbox{\hyperlink{classJumpTable}{Jump\+Table}} $\ast$}]{jump }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [pure virtual]}}



Eliminate any {\itshape guard} code involved in computing the switch destination. 

We now think of the B\+R\+A\+N\+C\+H\+I\+ND as encompassing any guard function. 
\begin{DoxyParams}{Parameters}
{\em fd} & is the function containing the switch \\
\hline
{\em jump} & is the \mbox{\hyperlink{classJumpTable}{Jump\+Table}} owning {\bfseries{this}} model. \\
\hline
\end{DoxyParams}


Implemented in \mbox{\hyperlink{classJumpAssisted_a9162ab4e23d4d31e7b16e46a42442a98}{Jump\+Assisted}}, \mbox{\hyperlink{classJumpBasicOverride_a65b9faa5ee96e07e8a90ce492bc8c179}{Jump\+Basic\+Override}}, \mbox{\hyperlink{classJumpBasic_ae70d6baeeecb4b16e79de8516868ffe4}{Jump\+Basic}}, and \mbox{\hyperlink{classJumpModelTrivial_a063b80b921795c341598e643f5ee7cce}{Jump\+Model\+Trivial}}.

\mbox{\Hypertarget{classJumpModel_a7e8f2d4d8a1ae1954e00aae96c74a8c4}\label{classJumpModel_a7e8f2d4d8a1ae1954e00aae96c74a8c4}} 
\index{JumpModel@{JumpModel}!foldInNormalization@{foldInNormalization}}
\index{foldInNormalization@{foldInNormalization}!JumpModel@{JumpModel}}
\doxysubsubsection{\texorpdfstring{foldInNormalization()}{foldInNormalization()}}
{\footnotesize\ttfamily virtual \mbox{\hyperlink{classVarnode}{Varnode}}$\ast$ Jump\+Model\+::fold\+In\+Normalization (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classFuncdata}{Funcdata}} $\ast$}]{fd,  }\item[{\mbox{\hyperlink{classPcodeOp}{Pcode\+Op}} $\ast$}]{indop }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [pure virtual]}}



Do normalization of the given switch specific to {\bfseries{this}} model. 

The \mbox{\hyperlink{classPcodeOp}{Pcode\+Op}} machinery is removed so it looks like the C\+P\+U\+I\+\_\+\+B\+R\+A\+N\+C\+H\+I\+ND simply takes the switch variable as an input \mbox{\hyperlink{classVarnode}{Varnode}} and automatically interprets its values to reach the correct destination. 
\begin{DoxyParams}{Parameters}
{\em fd} & is the function containing the switch \\
\hline
{\em indop} & is the given switch as a C\+P\+U\+I\+\_\+\+B\+R\+A\+N\+C\+H\+I\+ND \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
the \mbox{\hyperlink{classVarnode}{Varnode}} holding the final unnormalized switch variable 
\end{DoxyReturn}


Implemented in \mbox{\hyperlink{classJumpAssisted_aa36ee3e6e3749c41a43a3801579095eb}{Jump\+Assisted}}, \mbox{\hyperlink{classJumpBasic_a8e275e4e4165100780429e12fac9b39b}{Jump\+Basic}}, and \mbox{\hyperlink{classJumpModelTrivial_a7170dd246a1befa4db84e9d9c1a6ee2f}{Jump\+Model\+Trivial}}.

\mbox{\Hypertarget{classJumpModel_a9c2326278dd18c9d78dd5cd5795e802b}\label{classJumpModel_a9c2326278dd18c9d78dd5cd5795e802b}} 
\index{JumpModel@{JumpModel}!recoverModel@{recoverModel}}
\index{recoverModel@{recoverModel}!JumpModel@{JumpModel}}
\doxysubsubsection{\texorpdfstring{recoverModel()}{recoverModel()}}
{\footnotesize\ttfamily virtual bool Jump\+Model\+::recover\+Model (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classFuncdata}{Funcdata}} $\ast$}]{fd,  }\item[{\mbox{\hyperlink{classPcodeOp}{Pcode\+Op}} $\ast$}]{indop,  }\item[{uint4}]{matchsize,  }\item[{uint4}]{maxtablesize }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [pure virtual]}}



Attempt to recover details of the model, given a specific B\+R\+A\+N\+C\+H\+I\+ND. 

This generally recovers the normalized switch variable and any guards. 
\begin{DoxyParams}{Parameters}
{\em fd} & is the function containing the switch \\
\hline
{\em indop} & is the given B\+R\+A\+N\+C\+H\+I\+ND \\
\hline
{\em matchsize} & is the expected number of address table entries to recover, or 0 for no expectation \\
\hline
{\em maxtablesize} & is maximum number of address table entries to allow in the model \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
{\bfseries{true}} if details of the model were successfully recovered 
\end{DoxyReturn}


Implemented in \mbox{\hyperlink{classJumpAssisted_a54a3d21e91b75d420340cd403a53fc63}{Jump\+Assisted}}, \mbox{\hyperlink{classJumpBasicOverride_a4fd706bf7ee1023bd1d93c78ba66852f}{Jump\+Basic\+Override}}, \mbox{\hyperlink{classJumpBasic2_adc60ecb0d804d1a7754161b38ae3299f}{Jump\+Basic2}}, \mbox{\hyperlink{classJumpBasic_aebf055ad4baf1a138107d8dd3a40c809}{Jump\+Basic}}, and \mbox{\hyperlink{classJumpModelTrivial_ae05a183588550bc9102e12c80d7124b5}{Jump\+Model\+Trivial}}.

\mbox{\Hypertarget{classJumpModel_a76a52bf3311e9d97a61d1117f6de1b0a}\label{classJumpModel_a76a52bf3311e9d97a61d1117f6de1b0a}} 
\index{JumpModel@{JumpModel}!sanityCheck@{sanityCheck}}
\index{sanityCheck@{sanityCheck}!JumpModel@{JumpModel}}
\doxysubsubsection{\texorpdfstring{sanityCheck()}{sanityCheck()}}
{\footnotesize\ttfamily virtual bool Jump\+Model\+::sanity\+Check (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classFuncdata}{Funcdata}} $\ast$}]{fd,  }\item[{\mbox{\hyperlink{classPcodeOp}{Pcode\+Op}} $\ast$}]{indop,  }\item[{vector$<$ \mbox{\hyperlink{classAddress}{Address}} $>$ \&}]{addresstable }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [pure virtual]}}



Perform a sanity check on recovered addresses. 

Individual addresses are checked against the function or its program to determine if they are reasonable. This method can optionally remove addresses from the table. If it does so, the underlying model is changed to reflect the removal. 
\begin{DoxyParams}{Parameters}
{\em fd} & is the function containing the switch \\
\hline
{\em indop} & is the root B\+R\+A\+N\+C\+H\+I\+ND of the switch \\
\hline
{\em addresstable} & is the list of recovered Addresses, which may be modified \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
{\bfseries{true}} if there are (at least some) reasonable addresses in the table 
\end{DoxyReturn}


Implemented in \mbox{\hyperlink{classJumpAssisted_acda2c7e13c4b78b8c229e63fad03374b}{Jump\+Assisted}}, \mbox{\hyperlink{classJumpBasicOverride_a050d3faa295ff61d04f1406443ac83b1}{Jump\+Basic\+Override}}, \mbox{\hyperlink{classJumpBasic_a1cba6b6c963e4a70efc439c27e53bd44}{Jump\+Basic}}, and \mbox{\hyperlink{classJumpModelTrivial_a68d3e47c3ec7554f8a7d6800017d2ead}{Jump\+Model\+Trivial}}.



The documentation for this class was generated from the following file\+:\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{jumptable_8hh}{jumptable.\+hh}}\end{DoxyCompactItemize}
