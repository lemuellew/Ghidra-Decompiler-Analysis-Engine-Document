\hypertarget{classRulePtrArith}{}\doxysection{Rule\+Ptr\+Arith Class Reference}
\label{classRulePtrArith}\index{RulePtrArith@{RulePtrArith}}


Transform pointer arithmetic.  




Inheritance diagram for Rule\+Ptr\+Arith\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=155pt]{classRulePtrArith__inherit__graph}
\end{center}
\end{figure}


Collaboration diagram for Rule\+Ptr\+Arith\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=155pt]{classRulePtrArith__coll__graph}
\end{center}
\end{figure}
\doxysubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
virtual \mbox{\hyperlink{classRule}{Rule}} $\ast$ \mbox{\hyperlink{classRulePtrArith_afe0c04cbed0b86e6c09ca29f4514531f}{clone}} (const \mbox{\hyperlink{classActionGroupList}{Action\+Group\+List}} \&grouplist) const
\begin{DoxyCompactList}\small\item\em Clone the \mbox{\hyperlink{classRule}{Rule}}. \end{DoxyCompactList}\item 
virtual void \mbox{\hyperlink{classRulePtrArith_a1671af63d66f70ec2746887d32dfa46e}{get\+Op\+List}} (vector$<$ uint4 $>$ \&oplist) const
\begin{DoxyCompactList}\small\item\em List of op codes this rule operates on. \end{DoxyCompactList}\item 
virtual int4 \mbox{\hyperlink{classRulePtrArith_a8b6d5d16ceb0884f97bebd712b9f6852}{apply\+Op}} (\mbox{\hyperlink{classPcodeOp}{Pcode\+Op}} $\ast$op, \mbox{\hyperlink{classFuncdata}{Funcdata}} \&data)
\begin{DoxyCompactList}\small\item\em Attempt to apply {\bfseries{this}} \mbox{\hyperlink{classRule}{Rule}}. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsection*{Additional Inherited Members}


\doxysubsection{Detailed Description}
Transform pointer arithmetic. 

\mbox{\hyperlink{classRule}{Rule}} for converting integer arithmetic to pointer arithmetic. A string of I\+N\+T\+\_\+\+A\+D\+Ds is converted into P\+T\+R\+A\+D\+Ds and P\+T\+R\+S\+U\+Bs.

Basic algorithm\+: Starting with a varnode of known pointer type (with known size)\+:
\begin{DoxyItemize}
\item Generate list of terms added to pointer
\item Find all terms that are multiples of pointer size
\item Find all terms that are smaller than pointer size
\item Find sum of constants smaller than pointer size
\item Multiples get converted to P\+T\+R\+A\+DD
\item Constant gets converted to nearest subfield offset
\item Everything else is just added back on
\end{DoxyItemize}

We need to be wary of most things being in the units of the space being pointed at. Type calculations are always in bytes so we need to convert between space units and bytes. 

\doxysubsection{Member Function Documentation}
\mbox{\Hypertarget{classRulePtrArith_a8b6d5d16ceb0884f97bebd712b9f6852}\label{classRulePtrArith_a8b6d5d16ceb0884f97bebd712b9f6852}} 
\index{RulePtrArith@{RulePtrArith}!applyOp@{applyOp}}
\index{applyOp@{applyOp}!RulePtrArith@{RulePtrArith}}
\doxysubsubsection{\texorpdfstring{applyOp()}{applyOp()}}
{\footnotesize\ttfamily int4 Rule\+Ptr\+Arith\+::apply\+Op (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classPcodeOp}{Pcode\+Op}} $\ast$}]{op,  }\item[{\mbox{\hyperlink{classFuncdata}{Funcdata}} \&}]{data }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}}



Attempt to apply {\bfseries{this}} \mbox{\hyperlink{classRule}{Rule}}. 

This method contains the main logic for applying the \mbox{\hyperlink{classRule}{Rule}}. It must use a given \mbox{\hyperlink{classPcodeOp}{Pcode\+Op}} as the point at which the \mbox{\hyperlink{classRule}{Rule}} applies. If it does apply, changes are made directly to the function and 1 (non-\/zero) is returned, otherwise 0 is returned. 
\begin{DoxyParams}{Parameters}
{\em op} & is the given \mbox{\hyperlink{classPcodeOp}{Pcode\+Op}} where the \mbox{\hyperlink{classRule}{Rule}} may apply \\
\hline
{\em data} & is the function to which to apply \\
\hline
\end{DoxyParams}


Reimplemented from \mbox{\hyperlink{classRule_a4e3e61f066670175009f60fb9dc60848}{Rule}}.

\mbox{\Hypertarget{classRulePtrArith_afe0c04cbed0b86e6c09ca29f4514531f}\label{classRulePtrArith_afe0c04cbed0b86e6c09ca29f4514531f}} 
\index{RulePtrArith@{RulePtrArith}!clone@{clone}}
\index{clone@{clone}!RulePtrArith@{RulePtrArith}}
\doxysubsubsection{\texorpdfstring{clone()}{clone()}}
{\footnotesize\ttfamily virtual \mbox{\hyperlink{classRule}{Rule}}$\ast$ Rule\+Ptr\+Arith\+::clone (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{classActionGroupList}{Action\+Group\+List}} \&}]{grouplist }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [virtual]}}



Clone the \mbox{\hyperlink{classRule}{Rule}}. 

If {\bfseries{this}} \mbox{\hyperlink{classRule}{Rule}} is a member of one of the groups in the grouplist, this returns a clone of the \mbox{\hyperlink{classRule}{Rule}}, otherwise N\+U\+LL is returned. 
\begin{DoxyParams}{Parameters}
{\em grouplist} & is the list of groups being cloned \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
the cloned \mbox{\hyperlink{classRule}{Rule}} or N\+U\+LL 
\end{DoxyReturn}


Implements \mbox{\hyperlink{classRule_a70de90a76461bfa7ea0b575ce3c11e4d}{Rule}}.

\mbox{\Hypertarget{classRulePtrArith_a1671af63d66f70ec2746887d32dfa46e}\label{classRulePtrArith_a1671af63d66f70ec2746887d32dfa46e}} 
\index{RulePtrArith@{RulePtrArith}!getOpList@{getOpList}}
\index{getOpList@{getOpList}!RulePtrArith@{RulePtrArith}}
\doxysubsubsection{\texorpdfstring{getOpList()}{getOpList()}}
{\footnotesize\ttfamily void Rule\+Ptr\+Arith\+::get\+Op\+List (\begin{DoxyParamCaption}\item[{vector$<$ uint4 $>$ \&}]{oplist }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [virtual]}}



List of op codes this rule operates on. 

Populate the given array with all possible Op\+Codes this \mbox{\hyperlink{classRule}{Rule}} might apply to. By default, this method returns all possible Op\+Codes 
\begin{DoxyParams}{Parameters}
{\em oplist} & is the array to populate \\
\hline
\end{DoxyParams}


Reimplemented from \mbox{\hyperlink{classRule_a4023bfc7825de0ab866790551856d10e}{Rule}}.



The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{ruleaction_8hh}{ruleaction.\+hh}}\item 
ruleaction.\+cc\end{DoxyCompactItemize}
